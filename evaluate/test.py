import json
from evaluator_cycles import EvaluatorCycles
import networkx as nx
import string
import re

filename = '../data/toyworld2-500000.json'

with open(filename) as f:
   reactions = json.load(f)
e = EvaluatorCycles(reactions=reactions['reactions'])

# e.get_population_stoichiometry(max_depth=10, minimum_length=10, minimum_stoichiometry=3)

seed = '[H]c1n[c][c]n[c-][n-][c]n1'
cycles = e.get_reactant_stoichiometry(seed, minimum_stoichiometry=4, max_depth=10)

# cycles = [{'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[H+]+2[c]1[c]n[c-][n-][c]n[c-]n1', u'[c]1[c]n[c-][n-][c]n[c-]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[N-]=[N-]>', '>2[N-]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[N-]', '1[N-]+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1+1[N-]', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[H+]+2[c]1[c]n[c-][n-][c]n[c-]n1', u'[c]1[c]n[c-][n-][c]n[c-]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[N-]=[N-]>', '>2[N-]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[N-]', '1[N-]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[N-]+1[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[H+]+2[c]1[c]n[c-][n-][c]n[c-]n1', u'[c]1[c]n[c-][n-][c]n[c-]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[N-]=[N-]>', '>2[N-]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[N-]', '1[N-]+1[H]c1n[c][c]n[c-]n([H])[c]n1>', '>1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1+1[N-]', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[H+]+2[c]1[c]n[c-][n-][c]n[c-]n1', u'[c]1[c]n[c-][n-][c]n[c-]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]nc([H])[n-][c]n1', u'[H]c1n[c][c]nc([H])[n-][c]n1', '1[H]c1n[c][c]n[c-][n-][c]n1+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[H+]+2[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[H+]+2[c]1[c]n[c-][n-][c]n[c-]n1', u'[c]1[c]n[c-][n-][c]n[c-]n1', '1[H]c1n[c][c]nc([H])n([H])[c]n1+1[c]1[c]n[c-][n-][c]n[c-]n1>', '>1[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]nc([H])[n-][c]n1', u'[H]c1n[c][c]nc([H])[n-][c]n1', '1[H]c1n[c][c]n[c-][n-][c]n1+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[H+]+2[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[H+]+2[c]1[c]n[c-][n-][c]n[c-]n1', u'[c]1[c]n[c-][n-][c]n[c-]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[N-][N-]>', '>2[N-]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[N-]', '1[N-]+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1+1[N-]', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[H+]+2[c]1[c]n[c-][n-][c]n[c-]n1', u'[c]1[c]n[c-][n-][c]n[c-]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[N-][N-]>', '>2[N-]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[N-]', '1[N-]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[N-]+1[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[H+]+2[c]1[c]n[c-][n-][c]n[c-]n1', u'[c]1[c]n[c-][n-][c]n[c-]n1', '1[c]1[c]n[c-][n-][c]n[c-]n1+1[N-][N-]>', '>2[N-]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[N-]', '1[N-]+1[H]c1n[c][c]n[c-]n([H])[c]n1>', '>1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1+1[N-]', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H][N][N][H]+1[H+]>', '>1[H+]+2[H][N]', u'[H][N]', '1[H][N]+1[H]c1n[c][c]n[c-]n([H])[c]n1>', '>1[H+]+1[H][N]+1[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H][N][N][H]+1[H+]>', '>1[H+]+2[H][N]', u'[H][N]', '1[H][N]+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[H+]+1[H][N]+1[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H][N][N][H]+1[H+]>', '>1[H+]+2[H][N]', u'[H][N]', '1[H][N]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[H][N]+1[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H][N][N][H]+1[H+]>', '>1[H+]+2[H][N]', u'[H][N]', '1[H][N]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1+1[N-]', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H+]+1[N-]=[N-]>', '>1[H+]+2[N-]', u'[N-]', '1[N-]+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1+1[N-]', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H+]+1[N-]=[N-]>', '>1[H+]+2[N-]', u'[N-]', '1[N-]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[N-]+1[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H+]+1[N-]=[N-]>', '>1[H+]+2[N-]', u'[N-]', '1[N-]+1[H]c1n[c][c]n[c-]n([H])[c]n1>', '>1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1+1[N-]', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H+]+1[H]c1n[c][c]n[c-]n[c][n-]1>', '>1[H]c1n[c][c]nc([H])[n-][c]n1', u'[H]c1n[c][c]nc([H])[n-][c]n1', '1[H]c1n[c][c]n[c-][n-][c]n1+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[H+]+2[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H+]+1[N-][N-]>', '>1[H+]+2[N-]', u'[N-]', '1[N-]+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1+1[N-]', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H+]+1[N-][N-]>', '>1[H+]+2[N-]', u'[N-]', '1[N-]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>1[N-]+1[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H+]+1[N-][N-]>', '>1[H+]+2[N-]', u'[N-]', '1[N-]+1[H]c1n[c][c]n[c-]n([H])[c]n1>', '>1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1+1[N-]', '[H]c1n[c][c]n[c-][n-][c]n1']}, {'stoichiometry': 4, 'cycle': ['[H]c1n[c][c]n[c-][n-][c]n1', '1[H+]+1[H]c1n[c][c]n[c-][n-][c]n1>', '>2[H+]+1[c]1[c]n[c-][n-][c]n[c-]n1', u'[H+]', '1[H+]+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[H+]+1[H]c1n[c][c]nc([H])[n-][c]n1', u'[H]c1n[c][c]nc([H])[n-][c]n1', '1[H]c1n[c][c]n[c-][n-][c]n1+1[H]c1n[c][c]nc([H])[n-][c]n1>', '>1[H+]+2[H]c1n[c][c]n[c-][n-][c]n1', '[H]c1n[c][c]n[c-][n-][c]n1']}]

e.write_subset_to_graphml(seed, [x['cycle'] for x in cycles])
